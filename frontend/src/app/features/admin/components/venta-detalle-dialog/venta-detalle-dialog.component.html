<!-- Título del Diálogo -->
<h2 mat-dialog-title>
  <mat-icon>receipt_long</mat-icon>
  Detalle de Venta - Folio #{{ data.id }}
</h2>

<!-- Contenido del Diálogo -->
<mat-dialog-content class="mat-typography">

  <!-- Información General de la Venta -->
  <mat-list role="list" class="info-list">
    <mat-list-item role="listitem">
      <mat-icon matListItemIcon>calendar_month</mat-icon>
      <span matListItemTitle>{{ data.fechaVenta | date: 'dd/MM/yyyy HH:mm:ss' }}</span>
      <span matListItemLine>Fecha y Hora</span>
    </mat-list-item>
    <mat-list-item role="listitem">
      <mat-icon matListItemIcon>person</mat-icon>
      <span matListItemTitle>{{ data.nombreCliente || 'Consumidor Final' }}</span>
      <span matListItemLine>Cliente</span>
    </mat-list-item>
    <mat-list-item role="listitem">
      <mat-icon matListItemIcon>badge</mat-icon>
      <span matListItemTitle>{{ data.nombreUsuario || 'N/A' }}</span>
      <span matListItemLine>Vendedor</span>
    </mat-list-item>
  </mat-list>

  <hr>
  <h3>Productos Vendidos</h3>

  <!-- Tabla de Detalles (Productos) -->
  <div class="detalle-table-container mat-elevation-z2">
    <table mat-table [dataSource]="detalleDataSource">

      <!-- Columna Producto -->
      <ng-container matColumnDef="nombreProducto">
        <th mat-header-cell *matHeaderCellDef> Producto </th>
        <td mat-cell *matCellDef="let det"> {{det.nombreProducto}} </td>
      </ng-container>

      <!-- Columna Cantidad -->
      <ng-container matColumnDef="cantidad">
        <th mat-header-cell *matHeaderCellDef class="cell-center"> Cant. </th>
        <td mat-cell *matCellDef="let det" class="cell-center"> {{det.cantidad}} </td>
      </ng-container>

      <!-- Columna Precio Unitario -->
      <ng-container matColumnDef="precioUnitario">
        <th mat-header-cell *matHeaderCellDef class="cell-right"> P. Unit. </th>
        <td mat-cell *matCellDef="let det" class="cell-right">
          {{det.precioUnitario | currency: 'Q '}}
        </td>
      </ng-container>

      <!-- Columna Subtotal -->
      <ng-container matColumnDef="subtotal">
        <th mat-header-cell *matHeaderCellDef class="cell-right"> Subtotal </th>
        <td mat-cell *matCellDef="let det" class="cell-right">
          {{det.subtotal | currency: 'Q '}}
        </td>
      </ng-container>

      <!-- Definición de Filas -->
      <tr mat-header-row *matHeaderRowDef="detalleDisplayedColumns; sticky: true"></tr>
      <tr mat-row *matRowDef="let row; columns: detalleDisplayedColumns;"></tr>
    </table>
  </div>

  <!-- Resumen del Total -->
  <div class="total-summary">
    <span class="total-label">Total Venta</span>
    <span class="total-valor">{{ data.totalVenta | currency: 'Q ' }}</span>
  </div>

</mat-dialog-content>

<!-- Acciones (Botones) -->
<mat-dialog-actions align="end">
  <button mat-flat-button color="primary" (click)="cerrar()">
    <mat-icon>close</mat-icon>
    Cerrar
  </button>
</mat-dialog-actions>
